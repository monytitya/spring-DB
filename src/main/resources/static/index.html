<!-- <!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Analytics Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
  </style>
</head>

<body class="bg-[#F4F7F9] flex h-screen overflow-hidden">

  <aside class="w-64 bg-[#0F172A] text-slate-300 flex flex-col">
    <div class="p-6 text-white font-bold text-xl flex items-center gap-2">
      <div class="w-8 h-8 rounded-lg"></div>
      Demo Workspace
    </div>
    <nav class="flex-1 px-4 space-y-2 mt-4">
      <a href="#" class="block px-4 py-2 bg-blue-600 text-white rounded-md font-medium">1. Overview</a>
      <a href="#" class="block px-4 py-2 hover:bg-slate-800 rounded-md">2. Sales</a>
      <a href="#" class="block px-4 py-2 hover:bg-slate-800 rounded-md">3. Customers</a>
      <a href="#" class="block px-4 py-2 hover:bg-slate-800 rounded-md">4. Products</a>
    </nav>
  </aside>

  <main class="flex-1 flex flex-col overflow-y-auto">

    <header class="bg-white border-b px-8 py-4 flex justify-between items-center">
      <h1 class="text-2xl font-bold text-slate-800">1. Overview</h1>
      <div class="flex gap-3">
        <button onclick="openModal()"
          class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm transition">
          + Add User
        </button>
      </div>
    </header>

    <div class="p-8">

     
      <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
          <p class="text-slate-500 text-sm font-medium">Net Sales</p>
          <h2 class="text-3xl font-bold text-slate-900 mt-1">$24.0 M</h2>
          <p class="text-red-500 text-xs mt-2 font-semibold">↓ -5% <span class="text-slate-400 font-normal">vs last
              month</span></p>
        </div>
        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
          <p class="text-slate-500 text-sm font-medium">Orders</p>
          <h2 class="text-3xl font-bold text-slate-900 mt-1">3,070</h2>
          <p class="text-red-500 text-xs mt-2 font-semibold">↓ -4% <span class="text-slate-400 font-normal">vs last
              month</span></p>
        </div>
        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
          <p class="text-slate-500 text-sm font-medium">Active Users</p>
          <h2 id="user-count" class="text-3xl font-bold text-slate-900 mt-1">0</h2>
          <p class="text-green-500 text-xs mt-2 font-semibold">↑ 0% <span
              class="text-slate-400 font-normal">Stable</span></p>
        </div>
        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
          <p class="text-slate-500 text-sm font-medium">Profit Margin</p>
          <h2 class="text-3xl font-bold text-slate-900 mt-1">48%</h2>
          <div class="w-full bg-slate-100 h-1.5 mt-4 rounded-full">
            <div class="bg-blue-500 h-1.5 rounded-full w-[48%]"></div>
          </div>
        </div>
      </div>


      <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-6 mb-8">
        <h3 class="font-bold text-slate-700 mb-4">User Age Analytics</h3>
        <canvas id="userChart" height="100"></canvas>
      </div>

     
      <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
        <div class="p-4 border-b flex justify-between items-center bg-slate-50">
          <h3 class="font-bold text-slate-700">User Management</h3>
          <input id="search" type="text" placeholder="Search by name..."
            class="border rounded-lg px-4 py-2 text-sm w-64 focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>

        <table class="w-full text-left border-collapse">
          <thead>
            <tr class="text-slate-400 text-sm uppercase tracking-wider border-b">
              <th class="p-4 font-semibold">ID</th>
              <th class="p-4 font-semibold">User Name</th>
              <th class="p-4 font-semibold">Age</th>
              <th class="p-4 font-semibold text-right">Actions</th>
            </tr>
          </thead>
          <tbody id="table" class="text-slate-700"></tbody>
        </table>
      </div>
    </div>
  </main>


  <div id="modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center p-4">
    <div class="bg-white rounded-xl p-8 w-full max-w-md shadow-2xl">
      <h2 class="text-xl font-bold mb-4">Edit User Details</h2>
      <input id="id" type="hidden">
      <div class="space-y-4">
        <div>
          <label class="text-xs font-bold text-slate-500">FULL NAME</label>
          <input id="name" class="w-full border p-2 rounded mt-1 outline-blue-500">
        </div>
        <div>
          <label class="text-xs font-bold text-slate-500">AGE</label>
          <input id="age" type="number" class="w-full border p-2 rounded mt-1 outline-blue-500">
        </div>
        <div class="flex gap-2 pt-4">
          <button onclick="saveUser()" class="flex-1 bg-blue-600 text-white py-2 rounded-lg font-bold">Save
            Changes</button>
          <button onclick="closeModal()" class="flex-1 bg-slate-100 text-slate-600 py-2 rounded-lg">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    let users = [];
    let chart;

    async function loadUsers() {
      const res = await fetch("/users/all");
      users = await res.json();
      document.getElementById("user-count").innerText = users.length;
      render(users);
      renderChart(users);
    }

    function render(data) {
      const table = document.getElementById("table");
      table.innerHTML = data.map(u => `
        <tr class="border-b hover:bg-slate-50 transition">
          <td class="p-4 text-slate-400 font-mono text-xs">#${u.id ?? 'N/A'}</td>
          <td class="p-4 font-semibold">${u.name}</td>
          <td class="p-4"><span class="bg-slate-100 px-2 py-1 rounded text-sm">${u.age} yrs</span></td>
          <td class="p-4 text-right">
            <button onclick="editUser(${u.id}, '${u.name}', ${u.age})" class="text-blue-600 hover:underline text-sm font-medium">Edit</button>
            <button onclick="deleteUser(${u.id})" class="ml-3 text-red-500 hover:underline text-sm font-medium">Delete</button>
          </td>
        </tr>
      `).join('');
    }

    function renderChart(data) {
      const ctx = document.getElementById("userChart");

      const labels = data.map(u => u.name);
      const ages = data.map(u => u.age);

      if (chart) chart.destroy();

      chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Age',
            data: ages
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false }
          }
        }
      });
    }

    function saveUser() {
      const id = document.getElementById("id").value;
      const name = document.getElementById("name").value;
      const age = document.getElementById("age").value;

      const url = id ? `/users/update?id=${id}&name=${name}&age=${age}` : `/users/create?name=${name}&age=${age}`;

      fetch(url, { method: id ? 'PUT' : 'GET' })
        .then(() => {
          loadUsers();
          closeModal();
        });
    }

    function deleteUser(id) {
      if (confirm("Delete this user?")) {
        fetch(`/users/delete?id=${id}`).then(() => loadUsers());
      }
    }

    function editUser(id, name, age) {
      document.getElementById("id").value = id;
      document.getElementById("name").value = name;
      document.getElementById("age").value = age;
      openModal();
    }

    function openModal() {
      document.getElementById("modal").classList.remove("hidden");
    }

    function closeModal() {
      document.getElementById("modal").classList.add("hidden");
      document.getElementById("id").value = "";
      document.getElementById("name").value = "";
      document.getElementById("age").value = "";
    }

    document.getElementById("search").addEventListener("input", e => {
      const q = e.target.value.toLowerCase();
      render(users.filter(u => u.name.toLowerCase().includes(q)));
    });

    loadUsers();
  </script>

</body>

</html> -->